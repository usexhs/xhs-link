<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>xhslink Resolver</title>
</head>
<body>
    <h1>xhslink Resolver</h1>

    <p>Inspired by <a href="https://b23.wtf"><code>b23.wtf</code></a></p>

    <p>Remove hidden tracking parameters in xhslink dot com.</p>
    <p><strong>STILL UNDER INTENSIVE DEVELOPMENT</strong></p>
    <p>This site is also available at <a href="https://xhslink.icu"><code>xhslink.icu</code></a></p>
    
    <h2>Usage</h2>

        <p>Suppose you have a link like: <code>http://xhslink.com/YOUR_SHORTCODE</code></p>

        <strong>Redirect</strong>
        <p>Replace "com" with "icu" in your link. </p>
        <p><code>https://xhslink.icu/YOUR_SHORTCODE</code></p>

        <strong>Resolve the code</strong>
        <p><code>https://xhs.li/code/YOUR_SHORTCODE</code></p>

        <strong>Resolve the full URL</strong>
        <p><code>https://xhs.li/full/?url=http://xhslink.com/YOUR_SHORTCODE</code></p>


    <h2>Try it out</h2>
    <label for="fullurl">Enter your full URL here:</label>
    <input type="text" id="fullurl" name="fullurl" required>
    <button onclick="resolveFullURL()">Resolve</button>
    
    <p>Resolved URL: <code id="result"></code></p>
    <button onclick="copyToClipboard()">Copy to Clipboard</button>
    <span id="copied"></span>
    
    <p>---</p>
    <footer>
        <p>Â© 2023 Little Sweet Potato. All rights reserved. </p>
        <a href="https://github.com/usexhs/">Source Code</p>
    </footer>

    <script>
        function resolveFullURL() {
            document.getElementById("copied").innerText = '';

            var fullURL = document.getElementById("fullurl").value;
            var expr = /xhslink\.com\/([a-zA-Z0-9]+)/gm;
            var regex = new RegExp(expr);

            if (fullURL.match(regex)) {
                document.getElementById("result").innerText = 'URL found, resolving...';
                
                fullURL = fullURL.match(regex);

                fetch(`/full/?url=${fullURL}`)
                    .then(response => response.text())
                    .then(data => {
                        document.getElementById("result").innerText = `${data}`;
                    })
                    .catch(error => {
                        console.error('Error:', error);
                        document.getElementById("result").innerText = 'Error resolving the full URL.';
                    });
            }
            else {
                document.getElementById("result").innerText = 'No valid URL found';
            }
        };
        function copyToClipboard() {
            /* Get the text field */
            var copyText = document.getElementById("result");

            // Select the text field
            // copyText.select();
            // copyText.setSelectionRange(0, 99999); // For mobile devices

            // Copy the text inside the text field
            navigator.clipboard.writeText(copyText.innerText)
                .then(() => {
                    document.getElementById("copied").innerText = 'Copied!';
                })
                .catch((err) => {
                    document.getElementById("copied").innerText = 'Failed to Copy';
                    console.error('Unable to copy text: ', err);
                });

            /* Alert the copied text */
            
        }
    </script>
</body>
</html>

