<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="data:image/png;base64,iVBORw0KGgo=">
    <title>xhslink Resolver</title>
    <link rel="stylesheet" href="/static/css/noscript.css">
    <script src="/static/js/URL_handler.js"></script> 
</head>

<body>
    <noscript>
        <div class="noscript-overlay">
            <div class="noscript-dialog">
                <p><strong>This page needs Javascript enabled to work properly.</strong></p>
            </div>
        </div>
    </noscript>
    <div style="word-wrap: break-word; font-family: sans-serif;">

        <h1>xhslink Resolver</h1>

        <div>
            <p>A minimalist xhslink.com shortlink resolver, inspired by <a href="https://b23.wtf"><code>b23.wtf</code></a>.</p>
            <!-- <p>Remove tracking params in xhslink.com</p> -->
            <!-- <p>STILL UNDER INTENSIVE DEVELOPMENT</p> -->
        </div>

        <hr>

        <p>Replace "com" with <strong style="font-size: 1.2em;">"icu"</strong> to visit directly, or</p>
        <!-- <h2>Try it out</h2> -->
        <div>
            <p>
                <label for="fullurl">Enter your URL here to resolve:</label>
                <input type="text" id="fullurl" name="fullurl" required>
            </p>
            <button onclick="resolveFullURL(document.getElementById('fullurl').value)">Go!</button>

            <p>Result: <code id="result"></code></p>
            <p>
                <button onclick="copyToClipboard()">Copy to Clipboard</button>
                <span id="copied"></span>
            </p>
            <p>
                <button onclick="visitResolvedURL()">Open in New Tab</button>
                <span id="vru-error"></span>
            </p>
        </div>

        <hr>

        <h2>Usage Example</h2>

        <button onclick="toggleVisibility()" class="toggle-button">Show More</button>

        <div id="hidden-content" style="display: none;">

        <!-- <div> -->
            <p>Look at this text:</p>
            <p style="color: grey;max-width: 20em;">
                36 摆烂可耻但很快乐发布了一篇小红书笔记，快来看吧！
                😆 Ft0nRcmbgNxWi4i 😆 http://xhslink.com/o2s5so，
                复制本条信息，打开【小红书】App查看精彩内容！
            </p>

            <p>
                Just <strong>copy</strong> the text,
                <strong>paste</strong> into the form above,
                and you will get the original link.
            </p>
        <!-- </div> -->


            <!-- <p>You can also try the following usages:</p> -->
            <!-- <hr> -->
            <p><strong>Redirect</strong>: replace "com" with <strong style="font-size: 1.2em;">"icu"</strong>. </p>
            <div style="color: grey;">
                <code>$ curl -v http://xhslink.<strong style="font-size: 1.2em;">icu</strong>/o2s5so</code>
                <!-- <br><code>...</code>
            <br><code>< HTTP/1.1 301 Moved Permanently</code>
            <br><code>...</code>
            <br><code>< Location: https://xhslink.icu/o2s5so</code> -->
                <br><code>...</code>
                <br><code>&lt; HTTP/2 302 </code>
                <br><code>...</code>
                <br><code>&lt; location: https://www.xiaohongshu.com/discovery/item/6420c6650000000013011c8a</code>
                <br><code>...</code>
            <!-- <br><code>
                &lt;p&gt;You should be redirected automatically to the target URL: 
                &lt;a href=&quot;https://www.xiaohongshu.com/discovery/item/6420c6650000000013011c8a&quot;&gt;
                https://www.xiaohongshu.com/discovery/item/6420c6650000000013011c8a&lt;a&gt;. 
                If not, click the link.
            </code> -->

            </div>

            <p><strong>Resolve the code</strong></p>
            <div style="color: grey;">
                <code>$ curl https://xhslink.icu/code/o2s5so</code>
                <p><code>https://www.xiaohongshu.com/discovery/item/6420c6650000000013011c8a%</code></p>

            </div>
            <p><strong>Resolve the full URL</strong></p>
            <p style="max-width: 40em;"><em>
                    Actually, you can fill the whole shared text into the query string.
                    <br>This is the API behind the "Resolve" button above.
                </em></p>
            <div style="color: grey;">
                <p><code>$ curl https://xhslink.icu/full/?url=http://xhslink.com/o2s5so</code></p>
                <p><code>https://www.xiaohongshu.com/discovery/item/6420c6650000000013011c8a%</code></p>
            </div>
            <hr>

            <p><strong>By contrast</strong>, If you visit this shortlink directly, you will get:</p>
            <div style="color: grey;">
                <p><code>$ curl -I http://xhslink.com/o2s5so</code></p>
                <p><code>Location: https://www.xiaohongshu.com/discovery/item/6420c6650000000013011c8a?app_platform=ios&app_version=7.80&share_from_user_hidden=true&type=normal&xhsshare=CopyLink&appuid=5f2373dc0000000001008b32&apptime=1679927306</code></p>
            </div>
        </div>

        <hr>

        <footer>
            <p>Available at <a href="https://xhslink.icu"><code>xhslink.icu</code></a> & <a href="https://xhs.li"><code>xhs.li</code></a></p>
            <p>© Little Sweet Potato. This project is licensed under AGPLv3. <a href="https://github.com/usexhs/xhs-link">Source Code</a></p>
        </footer>

    </div>
    <script>
        function toggleVisibility() {
            var contentDiv = document.getElementById("hidden-content");
            var button = document.querySelector(".toggle-button");

            if (contentDiv.style.display === 'none') {
                contentDiv.style.display = 'block';
                button.textContent = 'Show Less';
            } else {
                contentDiv.style.display = 'none';
                button.textContent = 'Show More';
            }
        }
    </script>
</body>

</html>
